<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">

<head>
    <link rel="stylesheet" th:href="@{/css/cards.css}"/>
</head>

<body>

<th:block th:fragment="card(cardElement,cardType)" th:with="cardWidth=${cardWidth} ?: ${500}, isMain=${isMain} ?: ${false}">
    <div class="card" th:classappend="|${isMain ? 'card-main ' : ''}${cardType}|" th:style="|margin: auto; width: ${cardWidth}px; height: ${cardWidth/2}px;|">

        <div class="card-view">
            <div class="card-decoration">
                <div th:hidden="${cardElement.getImagePath() == ''}" class="imgcontainer" th:styleappend="${cardElement.getImagePath() != ''} ? 'background-image: url('+@{${cardElement.getImagePath()}}+')'"></div>
            </div>
            <div class="card-text">
                <h3 th:unless="${cardType} == 'infocard'" class="title" th:text="${cardElement.getTitle()}"><b> MindcardTitle </b></h3>
                <p hidden class="description" th:text="${cardElement.getDescription()}"> Description </p>
                <div class="unescapedDesc"></div>
            </div>
            <div class="cornerButtons">
                <button th:if="${cardElement.isOwned}" class="editCardButton">Edit</button>
            </div>
        </div>

        <form hidden th:if="${cardElement.isOwned}" class="card-editor" enctype="multipart/form-data">
            <input type="hidden" name="cardType" th:value="${cardType}"/>
            <input type="hidden" name="cardId" th:value="${cardElement.getCard().getPrimaryKey()}"/>
            <div class="card-decoration">
                <input type="file" name="image" class="imgcontainer"/>
            </div>
            <div class="card-text">
                <input th:unless="${cardType} == 'infocard'" name="title" class="title" type="text" th:value="${cardElement.getTitle()}" /><br/>
                <textarea name="description" class="description" th:rows="${isMain} ? 20 : 12" th:text="${cardElement.getDescription()}" ></textarea><br/>
                <label class="errorLabel" style="color: #f66;"></label>
            </div>
            <div class="cornerButtons">
                <button class="deleteCardButton">Delete</button>
                <button type="submit" class="saveCardButton">Save</button>
                <button class="cancelEditCardButton">Cancel</button>
            </div>
        </form>

    </div>
</th:block>



<th:block th:fragment="cardAdder(parentElement,cardType)" th:with="cardWidth=${cardWidth} ?: ${500}">
    <div class="card" th:classappend="${cardType}" th:style="|margin: auto; width: ${cardWidth}px; height: ${cardWidth/2}px;|">

        <div class="card-add">
            <img th:src="@{/images/asset/addCard.png}" th:style="|width: ${cardWidth/4}px; height: ${cardWidth/4}px;|"/>
        </div>

        <form hidden class="card-editor" enctype="multipart/form-data">
            <input type="hidden" name="cardType" th:value="${cardType}"/>
            <input type="hidden" name="parentCardId" th:value="${parentElement.getCard().getPrimaryKey()}"/>
            <div class="card-decoration">
                <input type="file" name="image" class="imgcontainer"/>
            </div>
            <div class="card-text">
                <input th:unless="${cardType} == 'infocard'" name="title" class="title" type="text" /><br/>
                <textarea name="description" class="description" th:rows="12" ></textarea><br/>
                <label class="errorLabel" style="color: #f66;"></label>
            </div>
            <div class="cornerButtons">
                <button type="submit" class="confirmAddCardButton">Save</button>
                <button class="cancelAddCardButton">Cancel</button>
            </div>
        </form>

    </div>
</th:block>



<th:block th:fragment="browserCard(cardElement,cardType)" th:with="cardWidth=${cardWidth} ?: ${300}">
    <div class="card browserCard" th:classappend="|${cardType}|" th:style="|margin: auto; width: ${cardWidth}px; height: ${cardWidth/2}px;|">

        <span class="cardId" hidden th:text="${cardElement.getCard().getPrimaryKey()}"></span>
        <span class="cardLink" hidden th:text="|/${cardType}/${cardElement.getCard().getPrimaryKey()}|"></span>
        <div class="card-view">
            <div class="card-decoration">
                <div th:hidden="${cardElement.getImagePath() == ''}" class="imgcontainer" th:styleappend="${cardElement.getImagePath() != ''} ? 'background-image: url('+@{${cardElement.getImagePath()}}+')'"></div>
            </div>
            <div class="card-text">
                <h3 th:unless="${cardType} == 'infocard'" class="title" th:text="${cardElement.getTitle()}"><b> MindcardTitle </b></h3>
                <p hidden class="description" th:text="${cardElement.getDescription()}"> Description </p>
                <div class="unescapedDesc"></div>
            </div>
            <div class="cornerButtons">
                <div th:if="${cardType} == 'deck'">
                    <input type="image" class="favouriteButton" th:classappend="|${cardElement.isFavourited()} ? 'favourited' : ''|" th:src="${cardElement.isFavourited()} ? @{/images/asset/favourite.png} : @{/images/asset/favouriteEmpty.png}" th:style="|float: left; width: ${cardWidth/10}px; height: ${cardWidth/10}px;|"/>
                    <span th:text="${cardElement.getTotalFavourites()}" style="float: left; color: #fff;"></span>
                </div>
            </div>
        </div>

    </div>
</th:block>


</body>
</html>